
# Use fake to launch CMake to create Makefiles to build fake

configure:
  dependencies:
   - CMakeLists.txt
   - fake.yaml
  target: build/Makefile
  run: cmake -S . -B build

build:
  dependencies:
   - configure
   - src/ExecutionQueueBuilder.cpp
   - src/Task.cpp
   - src/main.cpp
   - include/ExecutionQueueBuilder.hpp
   - include/Task.hpp
  target: build/fake
  run: cmake --build build --target fake

build-tests:
  dependencies:
   - build
   - gtest/TaskClass.cpp
   - gtest/EQBuilderClass.cpp
  target: build/gtest/test
  run: cmake --build build --target test

run-tests:
  dependencies: build-tests
  run: cd build/gtest && ./test

install:
  dependencies: build
  target: /usr/local/bin/fake
  run: sudo cp -f build/fake /usr/local/bin

remove:
  run: sudo rm /usr/local/bin/fake

update:
  run: git pull

clean:
  run: rm -rf build

cyclic1: # Should fail as self-dependent
  dependencies: cyclic2
  run: echo "Hello "

cyclic2: # Should fail as self-dependent
  dependencies: cyclic1
  run: echo "world! "

cyclic3: # Should fail saying that cyclic1 is self-dependent
  dependencies: cyclic1
  run: echo "@_@ < 'im dizzy'"
